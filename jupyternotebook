# Importa as bibliotecas necessárias
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Configura o estilo dos gráficos
sns.set_style('whitegrid')

# O nome do arquivo do INEP para 2024 é 'microdados_ed_basica_2024.CSV'
# O código foi ajustado para usar a coluna correta do censo de 2024.
# O código foi ajustado para usar 'low_memory=False' e evitar o aviso.
df = pd.read_csv('microdados_ed_basica_2024.CSV', sep=';', encoding='latin-1', low_memory=False)

# Filtra dados para escolas ativas
# A coluna correta para 2024 é 'TP_SITUACAO_FUNCIONAMENTO'
df = df[df['TP_SITUACAO_FUNCIONAMENTO'] == 1]

# Calcula a porcentagem de escolas sem acesso a saneamento
# IN_AGUA_INEXISTENTE, IN_ENERGIA_INEXISTENTE, IN_ESGOTO_INEXISTENTE
colunas_infra = ['IN_AGUA_INEXISTENTE', 'IN_ENERGIA_INEXISTENTE', 'IN_ESGOTO_INEXISTENTE']
infra_faltante = df[colunas_infra].mean() * 100

plt.figure(figsize=(10, 6))
infra_faltante.plot(kind='bar', color=['#1f77b4', '#ff7f0e', '#2ca02c'])
plt.title('Porcentagem de Escolas sem Infraestrutura Básica (Censo 2024)', fontsize=16)
plt.ylabel('Porcentagem de Escolas (%)', fontsize=12)
plt.xlabel('Infraestrutura Faltante', fontsize=12)
plt.xticks(ticks=[0, 1, 2], labels=['Sem Água', 'Sem Energia', 'Sem Esgoto'], rotation=0)
plt.show()

# Análise por UF
infra_por_uf = df.groupby('CO_UF').agg({
    'IN_AGUA_INEXISTENTE': 'mean',
    'IN_ENERGIA_INEXISTENTE': 'mean',
    'IN_ESGOTO_INEXISTENTE': 'mean'
}) * 100

plt.figure(figsize=(15, 8))
infra_por_uf.plot(kind='bar', figsize=(15, 8))
plt.title('Porcentagem de Escolas sem Infraestrutura por UF', fontsize=16)
plt.ylabel('Porcentagem de Escolas (%)', fontsize=12)
plt.xlabel('Código da UF', fontsize=12)
plt.show()

